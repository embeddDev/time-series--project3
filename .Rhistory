xlab="Time",
ylab="House Price Index/Lease Index",
ylim=c(-2, 2),
col="black")
View(Data)
View(Data)
Data$Loans90[55:106] = 1
View(Data)
lines(Loans90, type='l')
detach(Data)
Data$Loans90[55:106] = 1
detach(Data)
#New intervention model for 90% loans in the economy
Loans90 = rep(0,times=length(Data$Month))
Loans90[]
# 1 juli 2004 - 1okt 2008
detach(Data)
attach(Data)
detach(Data)
#New intervention model for 90% loans in the economy
Loans90 = rep(0,times=length(Data$Month))
Loans90[]
# 1 juli 2004 - 1okt 2008
Data$Loans90[55:106] = 1
attach(Data)
lines(Loans90, type='l')
plot(Loans90)
#New intervention model for 90% loans in the economy
Loans90 = rep(0,times=length(Data$Month)
# 1 juli 2004 - 1okt 2008
Loans90[55:106] = 1
Loans90[55:106] = 1
Loans90 = rep(0,times=length(Data$Month)
# 1 juli 2004 - 1okt 2008
Loans90[55:106] = 1
Loans90[55:106] = 1
Loans90 = rep(0,times=length(Data$Month)
# 1 juli 2004 - 1okt 2008
Loans90 = rep(0,times=length(Data$Month))
#1 juli 2004 - 1okt 2008
Loans90 = rep(0,times=length(Data$Month))
#1 juli 2004 - 1okt 2008
Loans90[55:106] = 1
detach(Data)
Data$Loans90 = Loans90
plot(Loans90, type='l')
attach(Data)
lines(HousePriceIndex,type='l')
plot((HousePriceIndex-mean(HousePriceIndex))/sd(HousePriceIndex) ~YearMonth,
type="l",
main="Comparison",
xlab="Time",
ylab="House Price Index/Lease Index",
ylim=c(-2, 2),
col="black")
lines(HousePriceIndex,type='l' ~YearMonth)
lines(HousePriceIndex ~YearMonth,type='l' )
lines(Loans90 ~YearMonth,type='l' )
#NEw model with intervention model
HousePrice_mdl =lm(HousePriceIndex ~LeaseIndex+
ConstructionCostIndex+
LoansOfBanksToHouseholds+
PurchasingPower+
Inflation+
HousingFinished+
IndexLoans
)
summary(HousePrice_mdl)
plot(HousePriceIndex, type='l', col="blue")
lines(HousePrice_mdl$fit, type='l', col="red")
HousePrice_mdl =lm(HousePriceIndex ~LeaseIndex+
ConstructionCostIndex+
LoansOfBanksToHouseholds+
PurchasingPower+
Inflation+
HousingFinished+
IndexLoans+
Loans90
)
summary(HousePrice_mdl)
HousePrice_mdl =lm(HousePriceIndex ~LeaseIndex+
LoansOfBanksToHouseholds+
PurchasingPower+
Inflation+
HousingFinished+
IndexLoans+
Loans90
)
summary(HousePrice_mdl)
#PLOT HPI on fitted model
plot(HousePriceIndex, type='l', col="blue")
lines(HousePrice_mdl$fit, type='l', col="red")
HousePrice_mdl =lm(HousePriceIndex ~LeaseIndex+
LoansOfBanksToHouseholds+
PurchasingPower+
Inflation+
HousingFinished+
IndexLoans+
Loans90
)
summary(HousePrice_mdl)
#PLOT HPI on fitted model
plot(HousePriceIndex, type='l', col="blue")
lines(HousePrice_mdl$fit, type='l', col="red")
HousePrice_mdl =lm(HousePriceIndex ~LeaseIndex+
LoansOfBanksToHouseholds+
PurchasingPower+
Inflation+
HousingFinished+
IndexLoans+
Loans90
)
summary(HousePrice_mdl)
#PLOT HPI on fitted model
plot(HousePriceIndex, type='l', col="blue")
lines(HousePrice_mdl$fit, type='l', col="red")
HousePrice_mdl =lm(HousePriceIndex
~LoansOfBanksToHouseholds+
PurchasingPower+
Inflation+
HousingFinished+
IndexLoans+
Loans90
)
summary(HousePrice_mdl)
#PLOT HPI on fitted model
plot(HousePriceIndex, type='l', col="blue")
lines(HousePrice_mdl$fit, type='l', col="red")
HousePrice_mdl =lm(HousePriceIndex
~LoansOfBanksToHouseholds+
PurchasingPower+
HousingFinished+
IndexLoans+
Loans90
)
summary(HousePrice_mdl)
#PLOT HPI on fitted model
plot(HousePriceIndex, type='l', col="blue")
lines(HousePrice_mdl$fit, type='l', col="red")
HousePrice_mdl =lm(HousePriceIndex
~LoansOfBanksToHouseholds+
PurchasingPower+
HousingFinished+
IndexLoans+
Loans90
)
summary(HousePrice_mdl)
#PLOT HPI on fitted model
plot(HousePriceIndex, type='l', col="blue")
lines(HousePrice_mdl$fit, type='l', col="red")
#NEw model with intervention model
HousePrice_mdl =lm(HousePriceIndex
~LoansOfBanksToHouseholds+
PurchasingPower+
HousingFinished+
Loans90
)
summary(HousePrice_mdl)
#PLOT HPI on fitted model
plot(HousePriceIndex, type='l', col="blue")
lines(HousePrice_mdl$fit, type='l', col="red")
#NEw model with intervention model
HousePrice_mdl =lm(HousePriceIndex
~LoansOfBanksToHouseholds+
PurchasingPower+
IndexLoans+
Loans90
)
summary(HousePrice_mdl)
#PLOT HPI on fitted model
plot(HousePriceIndex, type='l', col="blue")
lines(HousePrice_mdl$fit, type='l', col="red")
HousePrice_mdl =lm(HousePriceIndex
~LoansOfBanksToHouseholds+
PurchasingPower+
Inflation+
IndexLoans+
Loans90
)
summary(HousePrice_mdl)
#PLOT HPI on fitted model
plot(HousePriceIndex, type='l', col="blue")
lines(HousePrice_mdl$fit, type='l', col="red")
HousePrice_mdl =lm(HousePriceIndex ~LeaseIndex+
ConstructionCostIndex+
LoansOfBanksToHouseholds+
PurchasingPower+
Inflation+
HousingFinished+
Loans90
)
summary(HousePrice_mdl)
#PLOT HPI on fitted model
plot(HousePriceIndex, type='l', col="blue")
lines(HousePrice_mdl$fit, type='l', col="red")
HousePrice_mdl =lm(HousePriceIndex
~ConstructionCostIndex+
LoansOfBanksToHouseholds+
PurchasingPower+
Inflation+
HousingFinished+
Loans90
)
summary(HousePrice_mdl)
#PLOT HPI on fitted model
plot(HousePriceIndex, type='l', col="blue")
lines(HousePrice_mdl$fit, type='l', col="red")
#NEw model with intervention model
HousePrice_mdl =lm(HousePriceIndex
~ConstructionCostIndex+
LoansOfBanksToHouseholds+
Inflation+
HousingFinished+
Loans90
)
summary(HousePrice_mdl)
#PLOT HPI on fitted model
plot(HousePriceIndex, type='l', col="blue")
lines(HousePrice_mdl$fit, type='l', col="red")
#NEw model with intervention model
HousePrice_mdl =lm(HousePriceIndex
~ConstructionCostIndex+
LoansOfBanksToHouseholds+
HousingFinished+
Loans90
)
summary(HousePrice_mdl)
#PLOT HPI on fitted model
plot(HousePriceIndex, type='l', col="blue")
lines(HousePrice_mdl$fit, type='l', col="red")
#NEw model with intervention model
HousePrice_mdl =lm(HousePriceIndex
~ConstructionCostIndex+
LoansOfBanksToHouseholds+
HousingFinished+
Loans90+
LeaseIndex
)
summary(HousePrice_mdl)
#PLOT HPI on fitted model
plot(HousePriceIndex, type='l', col="blue")
lines(HousePrice_mdl$fit, type='l', col="red")
#NEw model with intervention model
HousePrice_mdl =lm(HousePriceIndex
~ConstructionCostIndex+
LoansOfBanksToHouseholds+
HousingFinished+
Loans90+
LeaseIndex
)
summary(HousePrice_mdl)
#PLOT HPI on fitted model
plot(HousePriceIndex, type='l', col="blue")
lines(HousePrice_mdl$fit, type='l', col="red")
#NEw model with intervention model
HousePrice_mdl =lm(HousePriceIndex
~ConstructionCostIndex+
LoansOfBanksToHouseholds+
HousingFinished+
Loans90+
LeaseIndex
)
summary(HousePrice_mdl)
#PLOT HPI on fitted model
plot(HousePriceIndex, type='l', col="blue")
lines(HousePrice_mdl$fit, type='l', col="red")
HousePrice_mdl =lm(HousePriceIndex
~ConstructionCostIndex+
LoansOfBanksToHouseholds+
HousingFinished+
Loans90+
)
summary(HousePrice_mdl)
#PLOT HPI on fitted model
plot(HousePriceIndex, type='l', col="blue")
lines(HousePrice_mdl$fit, type='l', col="red")
HousePrice_mdl =lm(HousePriceIndex
~ConstructionCostIndex+
LoansOfBanksToHouseholds+
HousingFinished+
Loans90+
)
summary(HousePrice_mdl)
#PLOT HPI on fitted model
plot(HousePriceIndex, type='l', col="blue")
lines(HousePrice_mdl$fit, type='l', col="red")
HousePrice_mdl =lm(HousePriceIndex
~ConstructionCostIndex+
LoansOfBanksToHouseholds+
HousingFinished+
Loans90+
)
summary(HousePrice_mdl)
HousePrice_mdl =lm(HousePriceIndex
~ConstructionCostIndex+
LoansOfBanksToHouseholds+
HousingFinished+
Loans90
)
summary(HousePrice_mdl)
#PLOT HPI on fitted model
plot(HousePriceIndex, type='l', col="blue")
lines(HousePrice_mdl$fit, type='l', col="red")
HousePrice_mdl =lm(HousePriceIndex
~ConstructionCostIndex+
LoansOfBanksToHouseholds+
HousingFinished+
IndexLoans+
Loans90
)
summary(HousePrice_mdl)
#PLOT HPI on fitted model
plot(HousePriceIndex, type='l', col="blue")
lines(HousePrice_mdl$fit, type='l', col="red")
detach(Data)
Data = read.csv("BuildingSupplyStore.csv", header=TRUE, sep= ";",dec=",")
attach(Data)
names(Data)
Data = read.csv("hpi.csv", header=TRUE, sep= ";",dec=",")
Building_Data = read.csv("BuildingSupplyStore.csv", header=TRUE, sep= ";",dec=",")
attach(Building_Data)
detach(Data)
Building_Data = read.csv("BuildingSupplyStore.csv", header=TRUE, sep= ";",dec=",")
attach(Building_Data)
names(Data)
detach(Data)
names(Data)
Building_Data = read.csv("BuildingSupplyStore.csv", header=TRUE, sep= ";",dec=",")
attach(Building_Data)
detach(Data)
detach(Data)
Building_Data = read.csv("BuildingSupplyStore.csv", header=TRUE, sep= ";",dec=",")
attach(Building_Data)
names(Building_Data)
View(Building_Data)
detach(Data)
Data = read.csv("BuildingSupplyStore.csv", header=TRUE, sep= ";",dec=",")
attach(Data)
View(Data)
View(Building_Data)
lines(lowess(Sales, f=.1), col = 2)
plot(Sales,type="l",pch=20,main="Sales")
lines(lowess(Sales, f=.1), col = 2)
plot(Sales~Week,pch=20,main="Yearly Sales")
View(Data)
View(Data)
names(Data)
plot(Sales~Week.of.Month,pch=20,main="Yearly Sales")
lines(lowess(Sales~Week.of.Month, f=.1), col = 2)
# ACF and PACF
acf(Sales) # Alot of MA, nonstationary TS
pacf(Sales) #AR(2)
detach(Data)
BuildingSupplyStore = read.csv("BuildingSupplyStore.csv", header=TRUE, sep= ";",dec=",")
attach(BuildingSupplyStore)
#Plot
plot(Sales,type="l",pch=20,main="Sales")
lines(lowess(Sales, f=.1), col = 2)
plot(Sales~Week.of.Month,pch=20,main="Yearly Sales")
lines(lowess(Sales~Week.of.Month, f=.1), col = 2)
# ACF and PACF
acf(Sales) # Alot of MA, nonstationary TS
pacf(Sales) #AR(3)
# Modeling
View(Building_Data)
names(BuildingSupplyStore)
pairs(BuildingSupplyStore[2:7], upper.panel = panel.cor,lower.panel = panel.smooth, diag.panel = panel.hist)
panel.cor.scale <- function(x, y, digits=2, prefix="", cex.cor)
{
usr <- par("usr"); on.exit(par(usr))
par(usr = c(0, 1, 0, 1))
r = (cor(x, y,use="pairwise"))
txt <- format(c(r, 0.123456789), digits=digits)[1]
txt <- paste(prefix, txt, sep="")
if(missing(cex.cor)) cex <- 0.8/strwidth(txt)
text(0.5, 0.5, txt, cex = cex * abs(r))
}
panel.cor <- function(x, y, digits=2, prefix="", cex.cor)
{
usr <- par("usr"); on.exit(par(usr))
par(usr = c(0, 1, 0, 1))
r = (cor(x, y,use="pairwise"))
txt <- format(c(r, 0.123456789), digits=digits)[1]
txt <- paste(prefix, txt, sep="")
if(missing(cex.cor)) cex <- 0.8/strwidth(txt)
text(0.5, 0.5, txt, cex = cex )
}
panel.hist <- function(x, ...)
{
usr <- par("usr"); on.exit(par(usr))
par(usr = c(usr[1:2], 0, 1.5) )
h <- hist(x, plot = FALSE)
breaks <- h$breaks; nB <- length(breaks)
y <- h$counts; y <- y/max(y)
rect(breaks[-nB], 0, breaks[-1], y, col="cyan", ...)
}
pairs.panels <- function (x,y,smooth=TRUE,scale=FALSE)
{if (smooth ){
if (scale) {
pairs(x,diag.panel=panel.hist,upper.panel=panel.cor.scale,lower.panel=panel.smooth)
}
else {pairs(x,diag.panel=panel.hist,upper.panel=panel.cor,lower.panel=panel.smooth)
} #else {pairs(x,diag.panel=panel.hist,upper.panel=panel.cor,lower.panel=panel.smooth)
}
else #smooth is not true
{ if (scale) {pairs(x,diag.panel=panel.hist,upper.panel=panel.cor.scale)
} else {pairs(x,diag.panel=panel.hist,upper.panel=panel.cor) }
} #end of else (smooth)
} #end of function
pairs(BuildingSupplyStore[2:7], upper.panel = panel.cor,lower.panel = panel.smooth, diag.panel = panel.hist)
pairs(BuildingSupplyStore[2,8:14], upper.panel = panel.cor,lower.panel = panel.smooth, diag.panel = panel.hist)
pairs(BuildingSupplyStore[c(2,15:22)], upper.panel = panel.cor,lower.panel = panel.smooth, diag.panel = panel.hist)
pairs(BuildingSupplyStore[c(2,8:14)], upper.panel = panel.cor,lower.panel = panel.smooth, diag.panel = panel.hist)
pairs(BuildingSupplyStore[c(2,15:22)], upper.panel = panel.cor,lower.panel = panel.smooth, diag.panel = panel.hist)
pairs(BuildingSupplyStore[2:7], upper.panel = panel.cor,lower.panel = panel.smooth, diag.panel = panel.hist)
pairs(BuildingSupplyStore[2:8], upper.panel = panel.cor,lower.panel = panel.smooth, diag.panel = panel.hist)
pairs(BuildingSupplyStore[c(2,9:14)], upper.panel = panel.cor,lower.panel = panel.smooth, diag.panel = panel.hist)
pairs(BuildingSupplyStore[2:8], upper.panel = panel.cor,lower.panel = panel.smooth, diag.panel = panel.hist)
pairs(BuildingSupplyStore[c(2,9:14)], upper.panel = panel.cor,lower.panel = panel.smooth, diag.panel = panel.hist)
pairs(BuildingSupplyStore[c(2,16:22)], upper.panel = panel.cor,lower.panel = panel.smooth, diag.panel = panel.hist)
plot(Sales~Week.of.Month,pch=20,main="Yearly Sales")
lines(lowess(Sales~Week.of.Month, f=.1), col = 2)
names(BuildingSupplyStore)
head(Date)
head(Date,20)
plot(Sales~Kalendar,pch=20,main="Yearly Sales")
kkalendar
kalendar
kalendar
View(BuildingSupplyStore)
plot(Sales,type="l",pch=20,main="Sales")
names(BuildingSupplyStore)
plot(Sales ~Date,type="l",pch=20,main="Sales")
class(Date)
plot(as.factor(Sales) ~Date,type="l",pch=20,main="Sales")
?factor
class(Date)
class(Sales)
plot(Sales ~is.numeric(Date),type="l",pch=20,main="Sales")
plot(Sales ~is.numeric(Date),type="l",pch=20,main="Sales",na.action=na.omit)
plot(Sales ~Date,type="l",pch=20,main="Sales")
plot(Sales ~Date,type="l",pch=20,main="Sales",lwd=4)
plot(Sales ~Date,type="l",pch=20,main="Sales",lwd=6)
plot(Sales ~Date,type="l",pch=20,main="Sales",lwd=10)
levels(Date)
Dates = as.numeric(Dates)
Dates = as.numeric(Date)
head(Dates)
Dates
Dates = is.numeric(Date)
Dates
plot.factor(Sales ~Date,type="l",pch=20,main="Sales")
Dates = as.numeric(as.character(Date))
Dates
Dates =(as.character(Date))
Dates
class(Date)
Dates =(as.numeric(Date))
class(Dates)
Dates
Dates = as.numeric(as.character(Date))
plot(Sales ~Date, type="l",main="Sales")
plot(Sales ~Date, type="l",main="Sales",col=3)
lines(lowess(Sales, f=.1), col = 2)
plot(Sales ~Date, type="l",main="Sales",col=3,lwd=5)
lines(lowess(Sales, f=.1), col = 2)
lines(lowess(Sales, f=.1), col = 2,lwd=4)
tail(Date)
1:5
1:10
weeks = c(1:52,1:52,1:52,1:26)
weeks
plot(Sales~weeks,pch=20,main="Yearly Sales")
lines(lowess(Sales~Week, f=.1), col = 2)
lines(lowess(Sales~Week, f=.1), col = 2)
lines(lowess(Sales~Weeks, f=.1), col = 2)
weeks = c(1:52,1:52,1:52,1:26)
plot(Sales~weeks,pch=20,main="Yearly Sales")
lines(lowess(Sales~Weeks, f=.1), col = 2)
lines(lowess(Sales~weeks, f=.1), col = 2)
lines(lowess(Sales~weeks, f=.1), col = 2,lwd=4)
lines(lowess(Sales~weeks, f=.5), col = 2,lwd=4)
lines(lowess(Sales~weeks, f=.99), col = 2,lwd=4)
plot(Sales~weeks,pch=20,main="Yearly Sales")
lines(lowess(Sales~weeks, f=.2), col = 2,lwd=4)
plot(Sales~weeks,pch=20,main="Yearly Sales")
lines(lowess(Sales~weeks, f=.15), col = 2,lwd=4)
sales.ts = ts(sales, f=52, start=2006 ,end = c(2009,26))
sales.ts = ts(Sales, f=52, start=2006 ,end = c(2009,26))
Sales.ts = ts(Sales, f=52, start=2006 ,end = c(2009,26))
Sales.ts
plot(decompose(Sales.ts))
plot(decompose(Sales.ts),col=2)
plot(decompose(Sales.ts),col="blue")
plot(decompose(diff(Sales.ts,1),col="blue")
)
plot(decompose(diff(Sales.ts,1),col="blue")
)
plot(decompose((diff(Sales.ts,1)),col="blue"))
plot(decompose((diff(Sales.ts,1))))
plot(decompose(Sales.ts),col="blue")
acf(Sales) # Alot of MA, nonstationary TS
pacf(Sales) #AR(3)
acf(Sales) # Alot of MA, nonstationary TS
acf(diff(Sales,1)) # Alot of MA, nonstationary TS
pacf(diff(Sales,1)) #AR(3)
detach(BuildingSupplyStore)
BuildingSupplyStore = within(BuildingSupplyStore,kalender = relevel(kalender,ref="Normal"))
names(Buil)
names(BuildingSupplyStore)
BuildingSupplyStore = within(BuildingSupplyStore,kalendar <- relevel(kalendar,ref="Normal"))
BuildingSupplyStore = within(BuildingSupplyStore,kalendar <- relevel(kalendar,ref="Normal"))
